ðŸ” Fuzzy Matching Explained

A key part of this agent is detecting patients even if thereâ€™s a typo in their name. This is done using:

from difflib import SequenceMatcher
score = SequenceMatcher(None, input_name.lower(), db_name.lower()).ratio()

1. How SequenceMatcher().ratio() Works

Itâ€™s mathematics, not randomness:

ratio
=
2
Ã—
ð‘€
ð‘‡
ratio=
T
2Ã—M
	â€‹


M = number of matching characters (in order)

T = total characters across both strings

ðŸ‘‰ Example:

DB: "Vidur Bera" (10 chars)

Input: "Vidurr Beraa" (12 chars)

Matching subsequence = "Vidur Bera" (10 chars)

ð‘€
=
10
,
â€…â€Š
ð‘‡
=
10
+
12
=
22
M=10,T=10+12=22
ratio
=
2
Ã—
10
22
=
0.91
ratio=
22
2Ã—10
	â€‹

=0.91

Score = 0.91 â†’ high similarity âœ…

2. Why AI-like?

Instead of == exact match, it measures closeness:

"Vidur Bera" vs "Vidurr Beraa" â†’ 0.91

"Vidur Bera" vs "Vidur Bora" â†’ 0.95

"Vidur Bera" vs "Anita Rao" â†’ 0.0

This mimics human reasoning: we know "Vidurr Beraa" is probably "Vidur Bera".

3. AI Evidence with DOB Rule

The agent combines fuzzy score + DOB:

if r_dob == dob_val and name_score > 0.7:
    return returning


If DOB matches and name_score > 0.7 â†’ Returning patient.

Else â†’ New patient.

This hybrid logic = AI heuristic (rules + similarity measure).

4. Why "name_score":1 but "combined":0.7?

Sometimes the name is an exact match â†’ score = 1.0.

But the system applies a threshold (0.7) to confirm.

So "combined":0.7 means: the systemâ€™s confidence threshold for recognition.

ðŸ“Š Example Experiments

We validated the agent with three experiments:

Returning patient (exact email match) â†’ Found instantly.

Returning patient (typo in name, DOB match) â†’ Fuzzy score > 0.7, recognized correctly.

New patient â†’ No match, created a new record, sent intake form.

All three confirm the systemâ€™s logic is working correctly.
